# modules/software.sh

## Overview

Contains a library of functions used in the MediaEase Project for managing software.

## Index

* [zen::software::is::installed](#zensoftwareisinstalled)

* [zen::software::port_randomizer](#zensoftwareportrandomizer)

* [zen::software::infobox](#zensoftwareinfobox)

* [zen::software::options::process](#zensoftwareoptionsprocess)

* [zen::software::backup::create](#zensoftwarebackupcreate)

* [zen::software::get_config_key_value](#zensoftwaregetconfigkeyvalue)

* [zen::software::autogen](#zensoftwareautogen)

* [zen::software::create](#zensoftwarecreate)


### zen::software::is::installed

This function checks if a specific software is installed for a given user by querying the database.

> [!NOTE]
> Ensures both software name and user ID are provided; if user ID is '*', checks for any user.

#### Examples

```bash
zen::software::is::installed "software_name" "user_id"
```

```bash
[[ $(zen::software::is::installed "subsonic" 6) ]] && echo "yes" || echo "no"
```

#### Arguments

* **$1** (string): Name (altname) of the software.
* **$2** (string): User ID to check the software installation for.

### zen::software::port_randomizer

This function generates a random port number within a specified range for an application, checking if the port is available.

> [!NOTE]
> If 'port_range' is specified as the port type, a range of ports is generated.

#### Example

```bash
zen::software::port_randomizer "app_name" "port_type"
```

#### Arguments

* **$1** (string): Name of the application.
* **$2** (string): Type of port to generate (default, ssl).

### zen::software::infobox

This function builds the header or footer for the software installer, displaying relevant information.

#### Example

```bash
zen::software::infobox "app_name" "shell_color" "action" "infobox_type"
```

#### Arguments

* **$1** (string): Name of the application.
* **$2** (string): Color to use for the text.
* **$3** (string): Action being performed (add, update, backup, reset, remove, reinstall).
* **$4** (string): "intro" for header, "outro" for footer.
* **$5** (string): (optional) Username to display in the infobox.
* **$6** (string): (optional) Password to display in the infobox.

### zen::software::options::process

This function processes software options from a comma-separated string, exporting variables for further use.

> [!NOTE]
> Variables are exported and used in other functions.

#### Example

```bash
zen::software::options::process "branch=beta,email=test@example.com"
```

#### Arguments

* **$1** (string): String of options in "option1=value1,option2=value2" format.

### zen::software::backup::create

This function handles the creation of software backups, ensuring the backup directory exists and backing up specified files.

> [!NOTE]
> Variable is defined in the main script.

#### Example

```bash
zen::software::backup::create "app_name"
```

#### Arguments

* **$1** (string): Name of the application.

### zen::software::get_config_key_value

This function retrieves a key/value from a YAML configuration file using a specified 'yq' expression.

> [!NOTE]
> This function will replace placeholders '%i' and '$app_name' with actual values.

#### Example

```bash
zen::software::get_config_key_value "config_file_path" "yq_expression"
```

#### Arguments

* **$1** (string): Path to the YAML configuration file.
* **$2** (string): 'yq' expression to evaluate in the configuration file.

### zen::software::autogen

This function automatically generates random values for specified keys, such as API keys, ports, and passwords.
shellcheck disable=SC2034
Â Disable SC2034 because the variables are exported and used in other functions

> [!NOTE]
> Variables are exported and used in other functions.

#### Example

```bash
zen::software::autogen
```

### zen::software::create

Prompts the user for details to create a new software entry.

#### Example

```bash
zen::software::create
```

#### Output on stdout

* Collects software details and creates the software entry.

---
This file was auto-generated by [shdoc](https://github.com/MediaEase/shdoc)
