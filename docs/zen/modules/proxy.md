# modules/proxy.sh

## Overview

Contains a library of functions used in the MediaEase Project for managing proxies.

## Index

* [zen::proxy::generate](#zenproxygenerate)

* [zen::proxy::add_directive](#zenproxyadddirective)

* [zen::proxy::remove](#zenproxyremove)


### zen::proxy::generate

This function creates a Caddy configuration file for a specified application.
It generates the configuration file based on the application name, port number, and base URL.
The configuration will differ based on whether the application is in multi-user mode or not.

> [!IMPORTANT]
> The Caddy configuration will be different in multi-user mode.

> [!CAUTION]
> Ensure the application name and port are correct to avoid misconfiguration.

#### Arguments

* **$1** (string): The name of the application.
* **$2** (number): The port on which the application is running.
* **$3** (string): The base URL for routing to the application.
* **$4** (boolean): Whether to reload Caddy after generating the configuration.

#### Exit codes

* **0**: Success.
* **1**: Failure due to directory creation errors or file writing errors.

#### Output on stdout

* Creates or overwrites a Caddy configuration file.

### zen::proxy::add_directive

This function appends a new directive to the Caddy proxy configuration of a specified application.
It is useful for adding custom rules or modifications to the existing proxy settings.

> [!NOTE]
> Use this function to add custom rules like security headers or rate limiting.

#### Arguments

* **$1** (string): The name of the application.
* **$2** (string): The username associated with the application (used in multi-user mode).
* **$3** (string): The directive to be added to the proxy configuration.
* **$4** (string): The position at which to add the directive ('in', 'before', 'after') - Default 'in' (the reverse_proxy block).
* **$5** (boolean): Whether to reload Caddy after adding the directive - Default false.

#### Exit codes

* **0**: Success.
* **1**: Failure due to file access or append errors.

#### Output on stdout

* Appends the specified directive to the application's Caddy configuration file.

### zen::proxy::remove

This function deletes the Caddy proxy configuration file associated with a given application.
It's used when an application's proxy is no longer needed or when the application is being uninstalled or moved.

> [!CAUTION]
> Removing the proxy configuration will make the application inaccessible through the proxy.

#### Arguments

* **$1** (string): The name of the application.
* **$2** (string): The username associated with the application (used in multi-user mode).

#### Exit codes

* **0**: Success.
* **1**: Failure due to file not found or deletion errors.

#### Output on stdout

* Deletes the Caddy configuration file for the specified application.

---
This file was auto-generated by [shdoc](https://github.com/MediaEase/shdoc)
